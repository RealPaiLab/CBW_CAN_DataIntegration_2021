<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 11 Lab 2: Pathway-level features | Multi-modal Data Integration</title>
  <meta name="description" content="Covers patient classification using multi-modal data integration" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 11 Lab 2: Pathway-level features | Multi-modal Data Integration" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Covers patient classification using multi-modal data integration" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 11 Lab 2: Pathway-level features | Multi-modal Data Integration" />
  
  <meta name="twitter:description" content="Covers patient classification using multi-modal data integration" />
  

<meta name="author" content="Instructor: Shraddha Pai" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CBW CAN Multi-modal Data Integration</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#course-materials"><i class="fa fa-check"></i>Course materials</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#labs"><i class="fa fa-check"></i>Labs</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#lab-1-a-gentle-introduction"><i class="fa fa-check"></i>LAB 1: A gentle introduction</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#lab-2-pathway-features-custom-similarity-metrics"><i class="fa fa-check"></i>LAB 2: Pathway features &amp; custom similarity metrics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#instructions"><i class="fa fa-check"></i>Instructions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><i class="fa fa-check"></i>Module 11 Lab 1: Three-way classifier from four genomic layers</a>
<ul>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#get-and-prepare-data"><i class="fa fa-check"></i>Get and prepare data</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#create-feature-design-rules"><i class="fa fa-check"></i>Create feature design rules</a>
<ul>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#grouplist"><i class="fa fa-check"></i>groupList</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#define-patient-similarity-for-each-network"><i class="fa fa-check"></i>Define patient similarity for each network</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#build-predictor"><i class="fa fa-check"></i>Build predictor</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#examine-results"><i class="fa fa-check"></i>Examine results</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html"><a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html#sessioninfo"><i class="fa fa-check"></i>sessionInfo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html"><i class="fa fa-check"></i>Module 11 Lab 2: Pathway-level features</a>
<ul>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#get-and-prepare-data-1"><i class="fa fa-check"></i>Get and prepare data</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#create-feature-design-rules-1"><i class="fa fa-check"></i>Create feature design rules</a>
<ul>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#rna-pathway-features"><i class="fa fa-check"></i>RNA: Pathway features</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#clinical-single-variables"><i class="fa fa-check"></i>Clinical: Single variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#build-predictor-1"><i class="fa fa-check"></i>Build predictor</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#examine-results-1"><i class="fa fa-check"></i>Examine results</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#visualize-top-pathways-in-cytoscape"><i class="fa fa-check"></i>Visualize top pathways in Cytoscape</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#outlook"><i class="fa fa-check"></i>Outlook</a></li>
<li class="chapter" data-level="" data-path="module-11-lab-2-pathway-level-features.html"><a href="module-11-lab-2-pathway-level-features.html#sessioninfo-1"><i class="fa fa-check"></i>sessionInfo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multi-modal Data Integration</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="module-11-lab-2-pathway-level-features" class="section level1">
<h1>Module 11 Lab 2: Pathway-level features</h1>
<p><strong>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license.</strong></p>
<div id="introduction-2" class="section level2">
<h2>Introduction</h2>
<p>In this example, we will learn how to:</p>
<ul>
<li>Use custom similarity metrics</li>
<li>Group variables into biologically-meaningful units such as pathways, for improved interpretability</li>
</ul>
<p>Here, we will again use breast cancer samples, and discriminate between Luminal A, Luminal B and basal-like tumours. We will limit ourselves to clinical data and gene expression data but will make the following design changes:</p>
<ul>
<li>Clinical variables: A feature (or patient similarity network;PSN) will be defined at the level of selected <em>variables</em> (e.g. age); we will define similarity as <em>normalized difference</em>.</li>
<li>Gene expression: Features will be defined at the level of <strong><em>pathways</em></strong>; i.e. each feature groups only those genes corresponding to the pathway. Similarity is defined as pairwise <em>Pearson correlation</em>.</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-36"></span>
<img src="images/Lab2_design.jpg" alt="Lab 2 design: We will integrate clinical and gene expression data. Each layer will be converted into a single patient similarity network using Pearson correlation for pairwise similarity." width="874" />
<p class="caption">
Figure 3: Lab 2 design: We will integrate clinical and gene expression data. Each layer will be converted into a single patient similarity network using Pearson correlation for pairwise similarity.
</p>
</div>
<div class="rmd-design">
<ol style="list-style-type: decimal">
<li>
<p>
In practice I recommend running a predictor design with 2-3 different sets of pathway definitions, and comparing the predictive pathway themes. For instance, it could be useful to compare results from using all curated pathways, to just domain-specific ones.<br />
Feature design is something of an art, and the choice of pathways depends on what your goals with building the predictor are. Are you looking to prioritize a known set of biological processes or interested in general discovery? These are tradeoffs. At the very least I would recommend running with all curated pathways as a baseline, because you may generate novel hypotheses.
</p>
</li>
<li>
<p>
Note that while in this design we group gene expression measures into pathways, the same design can be used to group other types of data based on prior knowledge. For instance, measures from imaging data could be grouped by prior knowledge of correlated networks of regions of interest subserving specific functions.
</p>
</li>
</ol>
</div>
</div>
<div id="get-and-prepare-data-1" class="section level2">
<h2>Get and prepare data</h2>
<p>Let’s fetch the BRCA data using <code>curatedTCGAData</code> again, this time only the gene expression data. Remember, the clinical data we automatically get in the <code>colData()</code> slot returned.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb66-1"><a href="module-11-lab-2-pathway-level-features.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(curatedTCGAData))</span>
<span id="cb66-2"><a href="module-11-lab-2-pathway-level-features.html#cb66-2" aria-hidden="true" tabindex="-1"></a>brca <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(</span>
<span id="cb66-3"><a href="module-11-lab-2-pathway-level-features.html#cb66-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">curatedTCGAData</span>(</span>
<span id="cb66-4"><a href="module-11-lab-2-pathway-level-features.html#cb66-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;BRCA&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;mRNAArray&quot;</span>),</span>
<span id="cb66-5"><a href="module-11-lab-2-pathway-level-features.html#cb66-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">dry.run=</span><span class="cn">FALSE</span>)</span>
<span id="cb66-6"><a href="module-11-lab-2-pathway-level-features.html#cb66-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>Let’s look at the data. Notice that we now only have one -omic assay, gene expression measures from microarrays.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb67-1"><a href="module-11-lab-2-pathway-level-features.html#cb67-1" aria-hidden="true" tabindex="-1"></a>brca</span></code></pre></div>
<pre><code>## A MultiAssayExperiment object of 1 listed
##  experiment with a user-defined name and respective class.
##  Containing an ExperimentList class object of length 1:
##  [1] BRCA_mRNAArray-20160128: SummarizedExperiment with 17814 rows and 590 columns
## Functionality:
##  experiments() - obtain the ExperimentList instance
##  colData() - the primary/phenotype DataFrame
##  sampleMap() - the sample coordination DataFrame
##  `$`, `[`, `[[` - extract colData columns, subset, or experiment
##  *Format() - convert into a long or wide DataFrame
##  assays() - convert ExperimentList to a SimpleList of matrices
##  exportClass() - save all data to files</code></pre>
<p>As before, we prepare the data. I highly recommend separating the script that prepares the data from the one running the predictor for improved management, readability and debuggability.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb69-1"><a href="module-11-lab-2-pathway-level-features.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;prepare_data.R&quot;</span>)</span>
<span id="cb69-2"><a href="module-11-lab-2-pathway-level-features.html#cb69-2" aria-hidden="true" tabindex="-1"></a>brca <span class="ot">&lt;-</span> <span class="fu">prepareDataForCBW</span>(brca, <span class="at">setBinary=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## harmonizing input:
##   removing 44 sampleMap rows with &#39;colname&#39; not in colnames of experiments</code></pre>
</div>
<div id="create-feature-design-rules-1" class="section level2">
<h2>Create feature design rules</h2>
<p>Load the <code>netDx</code> package and initialize the <code>groupList</code> object, where we will store our grouping rules.
Recall that <code>groupList</code> is a list-of-lists, with the top tier containing data layer names, and that the layer names must match <code>names(assays(brca))</code> or whatever your <code>MultiAssayExperiment</code> object is called.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb71-1"><a href="module-11-lab-2-pathway-level-features.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">require</span>(netDx)))</span>
<span id="cb71-2"><a href="module-11-lab-2-pathway-level-features.html#cb71-2" aria-hidden="true" tabindex="-1"></a>groupList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code></pre></div>
<div id="rna-pathway-features" class="section level3">
<h3>RNA: Pathway features</h3>
<p>Let’s group genes into <em>pathway-level features</em>, i.e. instead of one PSN for transcriptomic data, we create one PSN for each <em>pathway</em>. So if you had a pathway set with 2,000 curated pathways, <strong>this would generate 2,000 input PSN</strong>.</p>
<div class="rmd-caution">
<p>
This design changes model-building time to several hours, so avoid large gene sets (e.g. the full set of ~44,000 Gene Ontology terms, or even ~29,000 GO Biological Process terms). A reasonable start is a compilation of pathways from all curated pathway databases, as in below. Whichever list you use can be pruned by constraining the min/max number of genes in a set, but the size is something to keep in mind.
</p>
</div>
<p>There are two ways of providing pathway data to netDx:
1. You can <strong>download</strong> a compilation of pathways from curated databases using the <code>fetchPathwayDefinitions()</code> function in netDx, like so:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb72-1"><a href="module-11-lab-2-pathway-level-features.html#cb72-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">fetchPathwayDefinitions</span>(<span class="st">&quot;March&quot;</span>,<span class="dv">2021</span>)</span></code></pre></div>
<pre><code>## Fetching http://download.baderlab.org/EM_Genesets/March_01_2021/Human/symbol/Human_AllPathways_March_01_2021_symbol.gmt</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb74-1"><a href="module-11-lab-2-pathway-level-features.html#cb74-1" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##                                                                     BFC2 
## &quot;~/.cache/netDx/20e22fee64ce_Human_AllPathways_March_01_2021_symbol.gmt&quot;</code></pre>
<p>The above pathway set was downloaded from <a href="http://download.baderlab.org/EM_Genesets">download.baderlab.org/EM_Genesets</a>, which is a good resource for routinely-updated curated pathway definitions. Pathways are compiled from Reactome, Panther, NCI, MSigDB, etc.,,<span class="citation"><sup><a href="#ref-Merico2010-nc" role="doc-biblioref">5</a></sup></span> and data is contained in <a href="https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats#GMT:_Gene_Matrix_Transposed_file_format_.28.2A.gmt.29">GMT format</a>, a common format to represent gene-sets, such as pathways. You can see from the value of <code>x</code> that the file isn’t downloaded to our working directory, but rather is stored in a BioConductor-specific location for files (file cache), using the <a href="https://www.bioconductor.org/packages/release/bioc/html/BiocFileCache.html">BiocFileCache</a> class. This way if we rerun the script, BioConductor will only download the file again if it has changed since our last download.</p>
<p>Here is an example of the GMT format:</p>
<div class="figure"><span id="fig:unnamed-chunk-44"></span>
<img src="images/GMT_screenshot.png" alt="Lab 2: Example of GMT file format." width="937" />
<p class="caption">
Figure 4: Lab 2: Example of GMT file format.
</p>
</div>
<p>We then use <code>readPathways()</code> to read the pathways into a list format to provide the predictor with. So the full call looks like this:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb76-1"><a href="module-11-lab-2-pathway-level-features.html#cb76-1" aria-hidden="true" tabindex="-1"></a>pathList <span class="ot">&lt;-</span> <span class="fu">readPathways</span>(<span class="fu">fetchPathwayDefinitions</span>(<span class="st">&quot;March&quot;</span>,<span class="dv">2021</span>))</span></code></pre></div>
<pre><code>## ---------------------------------------</code></pre>
<pre><code>## Fetching http://download.baderlab.org/EM_Genesets/March_01_2021/Human/symbol/Human_AllPathways_March_01_2021_symbol.gmt</code></pre>
<pre><code>## File: 20e22fee64ce_Human_AllPathways_March_01_2021_symbol.gmt</code></pre>
<pre><code>## Warning in scan(f, what = &quot;character&quot;, nlines = 1, quiet = TRUE, sep = &quot;\t&quot;): EOF within quoted string</code></pre>
<pre><code>## Read 1123 pathways in total, internal list has 1110 entries</code></pre>
<pre><code>##  FILTER: sets with num genes in [10, 200]</code></pre>
<pre><code>##    =&gt; 341 pathways excluded
##    =&gt; 769 left</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb84-1"><a href="module-11-lab-2-pathway-level-features.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pathList)</span></code></pre></div>
<pre><code>## $STEARATE_BIOSYNTHESIS_I__ANIMALS_
##  [1] &quot;ELOVL1&quot;  &quot;ACOT7&quot;   &quot;ACSL1&quot;   &quot;ACSL5&quot;   &quot;ELOVL6&quot;  &quot;ACSL4&quot;   &quot;ACSL3&quot;   &quot;ACOT2&quot;   &quot;ACOT1&quot;   &quot;ACSBG1&quot;  &quot;ACSBG2&quot;  &quot;SLC27A2&quot; &quot;ACOT4&quot;  
## 
## $SUPERPATHWAY_OF_INOSITOL_PHOSPHATE_COMPOUNDS
##  [1] &quot;PI4K2B&quot;  &quot;MTMR14&quot;  &quot;INPPL1&quot;  &quot;PTEN&quot;    &quot;PIK3CD&quot;  &quot;PIK3C2G&quot; &quot;PIK3CB&quot;  &quot;PIK3C2A&quot; &quot;PIK3CG&quot;  &quot;PIK3C2B&quot; &quot;PIP4P2&quot;  &quot;PIP4P1&quot;  &quot;PLCZ1&quot;  
## [14] &quot;PPIP5K1&quot; &quot;PPIP5K2&quot; &quot;PIP5KL1&quot; &quot;PLCE1&quot;   &quot;PIP4K2A&quot; &quot;PIP4K2B&quot; &quot;PIP4K2C&quot; &quot;SACM1L&quot;  &quot;ITPK1&quot;   &quot;IPMK&quot;    &quot;OCRL&quot;    &quot;ITPKB&quot;   &quot;ITPKC&quot;  
## [27] &quot;MINPP1&quot;  &quot;PLCB3&quot;   &quot;PLCB4&quot;   &quot;PIK3CA&quot;  &quot;ITPKA&quot;   &quot;PIK3C3&quot;  &quot;PLCB1&quot;   &quot;PLCB2&quot;   &quot;PI4K2A&quot;  &quot;IPPK&quot;    &quot;MTMR3&quot;   &quot;PIK3R4&quot;  &quot;PIK3R3&quot; 
## [40] &quot;PIK3R2&quot;  &quot;PIK3R1&quot;  &quot;PIK3R6&quot;  &quot;PIK3R5&quot;  &quot;INPP5B&quot;  &quot;INPP5A&quot;  &quot;INPP5D&quot;  &quot;PLCG2&quot;   &quot;INPP5J&quot;  &quot;PIP5K1A&quot; &quot;INPP5K&quot;  &quot;PIP5K1B&quot; &quot;PIP5K1C&quot;
## [53] &quot;PLCG1&quot;   &quot;CDIPT&quot;   &quot;IP6K1&quot;   &quot;IP6K3&quot;   &quot;IP6K2&quot;   &quot;SYNJ2&quot;   &quot;FIG4&quot;    &quot;PIKFYVE&quot; &quot;SYNJ1&quot;   &quot;PI4KA&quot;   &quot;PLCH1&quot;   &quot;PI4KB&quot;   &quot;PLCH2&quot;  
## [66] &quot;PLCD3&quot;   &quot;PLCD4&quot;   &quot;PLCD1&quot;  
## 
## $PUTRESCINE_DEGRADATION_III
##  [1] &quot;ALDH3A2&quot; &quot;ALDH3B2&quot; &quot;ALDH3A1&quot; &quot;ALDH1B1&quot; &quot;MAOB&quot;    &quot;ALDH2&quot;   &quot;MAOA&quot;    &quot;ALDH3B1&quot; &quot;SAT2&quot;    &quot;SAT1&quot;   
## 
## $TRYPTOPHAN_DEGRADATION_III__EUKARYOTIC_
##  [1] &quot;ACAT1&quot; &quot;HADHB&quot; &quot;GCDH&quot;  &quot;TDO2&quot;  &quot;KYNU&quot;  &quot;HAAO&quot;  &quot;AFMID&quot; &quot;KMO&quot;   &quot;ACAA1&quot; &quot;ACAT2&quot; &quot;ACMSD&quot;
## 
## $MEVALONATE_PATHWAY_I
##  [1] &quot;ACAT1&quot;  &quot;IDI1&quot;   &quot;MVK&quot;    &quot;HMGCS1&quot; &quot;IDI2&quot;   &quot;HADHB&quot;  &quot;PMVK&quot;   &quot;MVD&quot;    &quot;HMGCR&quot;  &quot;HMGCS2&quot; &quot;ACAA1&quot;  &quot;ACAT2&quot; 
## 
## $`D-_I_MYO__I_-INOSITOL-5-PHOSPHATE_METABOLISM`
##  [1] &quot;PLCG1&quot;   &quot;PLCB3&quot;   &quot;PLCB4&quot;   &quot;PLCH1&quot;   &quot;PLCH2&quot;   &quot;PLCB1&quot;   &quot;MTMR14&quot;  &quot;PLCD3&quot;   &quot;PLCB2&quot;   &quot;PLCD4&quot;   &quot;PLCD1&quot;   &quot;MTMR3&quot;   &quot;PIP4P2&quot; 
## [14] &quot;PIP4P1&quot;  &quot;PLCZ1&quot;   &quot;PLCG2&quot;   &quot;PLCE1&quot;   &quot;PIP4K2A&quot; &quot;PIP4K2C&quot;</code></pre>
<ol style="list-style-type: decimal">
<li>Alternatively, you can also provide a custom pathway set to netDx by reading in a GMT file, using the <code>readPathways()</code> function. In this example, I’ve downloaded a geneset of <a href="http://www.gsea-msigdb.org/gsea/msigdb/collections.jsp#C7">pathways often dysregulated in cancer</a>, set C6 from MSigDB:<span class="citation"><sup><a href="#ref-Subramanian2005-am" role="doc-biblioref">6</a></sup></span></li>
</ol>
<div class="sourceCode" id="cb86"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb86-1"><a href="module-11-lab-2-pathway-level-features.html#cb86-1" aria-hidden="true" tabindex="-1"></a>gmtFile <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s2/cancer_pathways.gmt&quot;</span>,<span class="fu">tempdir</span>())</span>
<span id="cb86-2"><a href="module-11-lab-2-pathway-level-features.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s2&quot;</span>,<span class="fu">tempdir</span>()))) {</span>
<span id="cb86-3"><a href="module-11-lab-2-pathway-level-features.html#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s2&quot;</span>,<span class="fu">tempdir</span>()))</span>
<span id="cb86-4"><a href="module-11-lab-2-pathway-level-features.html#cb86-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-5"><a href="module-11-lab-2-pathway-level-features.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://raw.githubusercontent.com/RealPaiLab/CBW_CAN_DataIntegration_2021/master/supporting_files/c6.all.v7.4.symbols.gmt&quot;</span>,gmtFile)</span>
<span id="cb86-6"><a href="module-11-lab-2-pathway-level-features.html#cb86-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">readPathways</span>(gmtFile)</span></code></pre></div>
<pre><code>## ---------------------------------------</code></pre>
<pre><code>## File: cancer_pathways.gmt</code></pre>
<pre><code>## Read 189 pathways in total, internal list has 189 entries</code></pre>
<pre><code>##  FILTER: sets with num genes in [10, 200]</code></pre>
<pre><code>##    =&gt; 14 pathways excluded
##    =&gt; 175 left</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb92-1"><a href="module-11-lab-2-pathway-level-features.html#cb92-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## $GLI1_UP.V1_DN
##  [1] &quot;CACUL1&quot;  &quot;CCNL2&quot;   &quot;YIPF1&quot;   &quot;GTDC1&quot;   &quot;OPN3&quot;    &quot;SLC22A1&quot; &quot;RNF10&quot;   &quot;RUNX1&quot;   &quot;SEPTIN9&quot; &quot;CD2AP&quot;   &quot;ACSL6&quot;   &quot;ZMYND11&quot; &quot;FOLR1&quot;  
## [14] &quot;PPIL1&quot;   &quot;ESYT1&quot;   &quot;BTBD16&quot;  &quot;SPECC1&quot; 
## 
## $GLI1_UP.V1_UP
##  [1] &quot;IGFBP6&quot;  &quot;CCND2&quot;   &quot;PTH1R&quot;   &quot;TXNDC12&quot; &quot;M6PR&quot;    &quot;PPT2&quot;    &quot;STAU1&quot;   &quot;JCHAIN&quot;  &quot;TMOD3&quot;   &quot;SAR1A&quot;   &quot;ZBTB16&quot;  &quot;YBX1&quot;    &quot;SGTA&quot;   
## [14] &quot;WEE1&quot;    &quot;TRIM23&quot;  &quot;BMERB1&quot;  &quot;NPHP1&quot;   &quot;IFT74&quot;   &quot;PRKD3&quot;   &quot;PLPP6&quot;   &quot;FEM1A&quot;   &quot;LMO7&quot;    &quot;C7orf50&quot; &quot;ZC3H18&quot; 
## 
## $GCNP_SHH_UP_EARLY.V1_DN
##   [1] &quot;SRRM2&quot;    &quot;KIAA1217&quot; &quot;DEFA1&quot;    &quot;DLK1&quot;     &quot;PITX2&quot;    &quot;CCL2&quot;     &quot;UPK3B&quot;    &quot;SEZ6&quot;     &quot;TAF15&quot;    &quot;EMP1&quot;     &quot;SH3BGR&quot;   &quot;CCR2&quot;    
##  [13] &quot;VAV1&quot;     &quot;LGALS9&quot;   &quot;WIPF1&quot;    &quot;LYST&quot;     &quot;RRAGD&quot;    &quot;CPT1A&quot;    &quot;FAM241A&quot;  &quot;MAN2B1&quot;   &quot;WWC2&quot;     &quot;TXLNG&quot;    &quot;CNGA2&quot;    &quot;NPPB&quot;    
##  [25] &quot;MYO5B&quot;    &quot;XIAP&quot;     &quot;HOXB9&quot;    &quot;TASOR&quot;    &quot;PEX7&quot;     &quot;SOX18&quot;    &quot;CCRL2&quot;    &quot;NR6A1&quot;    &quot;CITED2&quot;   &quot;LTBP3&quot;    &quot;EEPD1&quot;    &quot;SIM1&quot;    
##  [37] &quot;CRABP2&quot;   &quot;PPFIBP2&quot;  &quot;CYBA&quot;     &quot;RAMP1&quot;    &quot;TM4SF1&quot;   &quot;LIN9&quot;     &quot;ASPH&quot;     &quot;UBTF&quot;     &quot;PIGT&quot;     &quot;EOMES&quot;    &quot;GBP7&quot;     &quot;MERTK&quot;   
##  [49] &quot;MAP3K12&quot;  &quot;IL1R1&quot;    &quot;HAS2&quot;     &quot;SLC43A3&quot;  &quot;CBX1&quot;     &quot;GLB1L&quot;    &quot;PHLDB2&quot;   &quot;GPR19&quot;    &quot;GUSB&quot;     &quot;CRYGS&quot;    &quot;DBP&quot;      &quot;VPS54&quot;   
##  [61] &quot;FRMD5&quot;    &quot;DCAF8&quot;    &quot;BTD&quot;      &quot;ADCY9&quot;    &quot;SIX4&quot;     &quot;PLA2G10&quot;  &quot;SLC6A4&quot;   &quot;GCSAM&quot;    &quot;CBFA2T3&quot;  &quot;GABRA1&quot;   &quot;S100A9&quot;   &quot;LAT2&quot;    
##  [73] &quot;SMYD5&quot;    &quot;MX2&quot;      &quot;AKR1C1&quot;   &quot;PLK2&quot;     &quot;PDE1B&quot;    &quot;ID2&quot;      &quot;HOXB3&quot;    &quot;GAPDHS&quot;   &quot;IER2&quot;     &quot;DDB1&quot;     &quot;ADAM7&quot;    &quot;ETS1&quot;    
##  [85] &quot;CDK5RAP3&quot; &quot;POLD4&quot;    &quot;ITGA4&quot;    &quot;FOXA1&quot;    &quot;PEPD&quot;     &quot;AMOTL2&quot;   &quot;CALCR&quot;    &quot;BPIFB1&quot;   &quot;MAF&quot;      &quot;EGR1&quot;     &quot;CYP27B1&quot;  &quot;URI1&quot;    
##  [97] &quot;HTRA3&quot;    &quot;LCP1&quot;     &quot;ACSS1&quot;    &quot;SETDB1&quot;   &quot;BTC&quot;      &quot;NOTCH1&quot;   &quot;NR5A2&quot;    &quot;LRRC57&quot;   &quot;TM2D1&quot;    &quot;RABAC1&quot;   &quot;DPPA4&quot;    &quot;CNN1&quot;    
## [109] &quot;JPH3&quot;     &quot;MAP4K4&quot;   &quot;CD38&quot;     &quot;SLC22A6&quot;  &quot;MIPOL1&quot;   &quot;NLRX1&quot;    &quot;GDF3&quot;     &quot;ZNF436&quot;   &quot;TIRAP&quot;    &quot;CFB&quot;      &quot;MST1R&quot;    &quot;NUB1&quot;    
## [121] &quot;H2BC21&quot;   &quot;IFNG&quot;     &quot;UROS&quot;     &quot;POPDC3&quot;   &quot;ERO1B&quot;    &quot;GRIN1&quot;    &quot;PPY&quot;      &quot;HES1&quot;     &quot;UIMC1&quot;    &quot;CAMLG&quot;    &quot;LRRC23&quot;   &quot;SLC7A3&quot;  
## [133] &quot;C4BPA&quot;    &quot;PPP2R3C&quot;  &quot;CDK5&quot;     &quot;MGP&quot;      &quot;STS&quot;      &quot;PCBD2&quot;    &quot;IRF3&quot;     &quot;RAG2&quot;     &quot;GABRD&quot;    &quot;ANKRD44&quot;  &quot;TERF2IP&quot;  &quot;CCL27&quot;   
## [145] &quot;LCLAT1&quot;   &quot;MIIP&quot;     &quot;TMPO&quot;     &quot;AGTR2&quot;    &quot;ELMOD3&quot;   &quot;GNA14&quot;    &quot;JAM3&quot;     &quot;RSPO2&quot;    &quot;CRYBG1&quot;   &quot;PTGER3&quot;   &quot;LSR&quot;      &quot;NSUN3&quot;   
## [157] &quot;MAP2K1&quot;   &quot;TMEM160&quot;  &quot;ZNF518B&quot;  &quot;NR4A2&quot;    &quot;PCP2&quot;     &quot;TMEM176A&quot; &quot;DDX3Y&quot;    &quot;MYRF&quot;     &quot;LAMB3&quot;    &quot;PLA2G4A&quot;  &quot;HTR1A&quot;</code></pre>
<p>For this tutorial we will limit ourselves to the first set of pathways and use <code>groupList</code> to tell netDx to group transcriptomic data using pathways.</p>
<div class="rmd-caution">
<p>
The pathway definition file should use the same identifier type as your patient data. For instance, if the genes in your transcriptomic data are represented using <a href="https://www.genenames.org/tools/search/">HGNC symbols</a>, then your pathway definition file must also use HGNC symbols (e.g. <em>ID2S</em>), and not a different type of identifier, such as Ensembl IDs (which look like this: <em>ENSG00000010404</em>).
</p>
</div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb94-1"><a href="module-11-lab-2-pathway-level-features.html#cb94-1" aria-hidden="true" tabindex="-1"></a>groupList[[<span class="st">&quot;BRCA_mRNAArray-20160128&quot;</span>]] <span class="ot">&lt;-</span> pathList[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] </span></code></pre></div>
</div>
<div id="clinical-single-variables" class="section level3">
<h3>Clinical: Single variables</h3>
<p>Models often include clinical variables such as demographic or disease-related features such as age, sex, or treatment regimen. In this example, we take two variables from the sample metadata, and include create one PSN <em>for each variable</em>.</p>
<p>So here, we map the following:</p>
<ul>
<li><code>patient.age_at_initial_pathologic_diagnosis</code> to <code>age</code> (just shorter)</li>
<li><code>stage</code> to <code>STAGE</code></li>
</ul>
<p>These variables must be present in the <code>colData()</code> slot:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb95-1"><a href="module-11-lab-2-pathway-level-features.html#cb95-1" aria-hidden="true" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> <span class="fu">colData</span>(brca)</span>
<span id="cb95-2"><a href="module-11-lab-2-pathway-level-features.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pheno[,<span class="fu">c</span>(<span class="st">&quot;patient.age_at_initial_pathologic_diagnosis&quot;</span>,<span class="st">&quot;STAGE&quot;</span>)])</span></code></pre></div>
<pre><code>## DataFrame with 6 rows and 2 columns
##              patient.age_at_initial_pathologic_diagnosis     STAGE
##                                                &lt;integer&gt; &lt;integer&gt;
## TCGA-A1-A0SD                                          59         2
## TCGA-A1-A0SE                                          56         1
## TCGA-A1-A0SH                                          39         2
## TCGA-A1-A0SJ                                          39         3
## TCGA-A1-A0SK                                          54         2
## TCGA-A1-A0SO                                          67         2</code></pre>
<p>We now add the entry into <code>groupList</code>. The entry for <code>clinical</code> is special because netDx will look for corresponding variables in the sample metadata table, <code>colData()</code>, rather than looking for “clinical” within <code>assays(brca)</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb97-1"><a href="module-11-lab-2-pathway-level-features.html#cb97-1" aria-hidden="true" tabindex="-1"></a>groupList[[<span class="st">&quot;clinical&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb97-2"><a href="module-11-lab-2-pathway-level-features.html#cb97-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">age=</span><span class="st">&quot;patient.age_at_initial_pathologic_diagnosis&quot;</span>,</span>
<span id="cb97-3"><a href="module-11-lab-2-pathway-level-features.html#cb97-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">stage=</span><span class="st">&quot;STAGE&quot;</span></span>
<span id="cb97-4"><a href="module-11-lab-2-pathway-level-features.html#cb97-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>We now tell netDx what similarity metric to use</p>
<p>This is <code>makeNets()</code> just as we had seen in the previous exercise, which provides <code>netDx</code> with a custom function to generate similarity networks (i.e. features). We previously used the following code to create PSN based on Pearson correlation: <code>makePSN_NamedMatrix(..., writeProfiles=TRUE,...)</code></p>
<p>We will now make a different call to <code>makePSN_NamedMatrix()</code> but this time, requesting the use of the normalized difference similarity metric.</p>
<p>This is achieved by calling the following code: <code>makePSN_NamedMatrix(,..., simMetric="custom", customFunc=normDiff,writeProfiles=FALSE)</code></p>
<p><code>normDiff</code> is a function provided in the <code>netDx</code> package, but the user may define custom similarity functions in this block of code and pass those to <code>makePSN_NamedMatrix()</code>, using the <code>customFunc</code> parameters; additionally set <code>simMetric</code> to <code>custom</code>.</p>
<p>Other presets provided by netDx include:</p>
<ul>
<li><code>sim.pearscale</code>: Pearson correlation followed by exponential scaling; used with a vector</li>
<li><code>sim.eucscale</code>: Euclidean disance followed by exponential scaling; used with a vector</li>
<li><code>normDiff</code>: Normalized difference; used with a single variable such as age</li>
<li><code>avgNormDiff</code>: Average normalized difference; used with a vector</li>
</ul>
<p>When we’re done, this is what the <code>makeNets</code> function look like.</p>
<p><em>Note: I realize this may be complicated. Future versions of netDx will simplify this syntax.</em></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb98-1"><a href="module-11-lab-2-pathway-level-features.html#cb98-1" aria-hidden="true" tabindex="-1"></a>makeNets <span class="ot">&lt;-</span> <span class="cf">function</span>(dataList, groupList, netDir,...) {</span>
<span id="cb98-2"><a href="module-11-lab-2-pathway-level-features.html#cb98-2" aria-hidden="true" tabindex="-1"></a>    netList <span class="ot">&lt;-</span> <span class="fu">c</span>() </span>
<span id="cb98-3"><a href="module-11-lab-2-pathway-level-features.html#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="module-11-lab-2-pathway-level-features.html#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make RNA nets (Pearson correlation)</span></span>
<span id="cb98-5"><a href="module-11-lab-2-pathway-level-features.html#cb98-5" aria-hidden="true" tabindex="-1"></a>    rna <span class="ot">&lt;-</span> <span class="st">&quot;BRCA_mRNAArray-20160128&quot;</span></span>
<span id="cb98-6"><a href="module-11-lab-2-pathway-level-features.html#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(groupList[[rna]])) { <span class="do">## REMEMBER TO CHECK FOR NULL</span></span>
<span id="cb98-7"><a href="module-11-lab-2-pathway-level-features.html#cb98-7" aria-hidden="true" tabindex="-1"></a>        netList <span class="ot">&lt;-</span> <span class="fu">makePSN_NamedMatrix</span>(</span>
<span id="cb98-8"><a href="module-11-lab-2-pathway-level-features.html#cb98-8" aria-hidden="true" tabindex="-1"></a>            dataList[[rna]],</span>
<span id="cb98-9"><a href="module-11-lab-2-pathway-level-features.html#cb98-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rownames</span>(dataList[[rna]]),</span>
<span id="cb98-10"><a href="module-11-lab-2-pathway-level-features.html#cb98-10" aria-hidden="true" tabindex="-1"></a>            groupList[[rna]],</span>
<span id="cb98-11"><a href="module-11-lab-2-pathway-level-features.html#cb98-11" aria-hidden="true" tabindex="-1"></a>            netDir,</span>
<span id="cb98-12"><a href="module-11-lab-2-pathway-level-features.html#cb98-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">verbose=</span><span class="cn">FALSE</span>,</span>
<span id="cb98-13"><a href="module-11-lab-2-pathway-level-features.html#cb98-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">writeProfiles=</span><span class="cn">TRUE</span>,         <span class="do">## define Pearson similarity as before</span></span>
<span id="cb98-14"><a href="module-11-lab-2-pathway-level-features.html#cb98-14" aria-hidden="true" tabindex="-1"></a>            ...) </span>
<span id="cb98-15"><a href="module-11-lab-2-pathway-level-features.html#cb98-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb98-16"><a href="module-11-lab-2-pathway-level-features.html#cb98-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb98-17"><a href="module-11-lab-2-pathway-level-features.html#cb98-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make clinical nets (normalized difference)</span></span>
<span id="cb98-18"><a href="module-11-lab-2-pathway-level-features.html#cb98-18" aria-hidden="true" tabindex="-1"></a>    netList2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb98-19"><a href="module-11-lab-2-pathway-level-features.html#cb98-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(groupList[[<span class="st">&quot;clinical&quot;</span>]])) {</span>
<span id="cb98-20"><a href="module-11-lab-2-pathway-level-features.html#cb98-20" aria-hidden="true" tabindex="-1"></a>    netList2 <span class="ot">&lt;-</span> <span class="fu">makePSN_NamedMatrix</span>(</span>
<span id="cb98-21"><a href="module-11-lab-2-pathway-level-features.html#cb98-21" aria-hidden="true" tabindex="-1"></a>        dataList<span class="sc">$</span>clinical, </span>
<span id="cb98-22"><a href="module-11-lab-2-pathway-level-features.html#cb98-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(dataList<span class="sc">$</span>clinical),</span>
<span id="cb98-23"><a href="module-11-lab-2-pathway-level-features.html#cb98-23" aria-hidden="true" tabindex="-1"></a>        groupList[[<span class="st">&quot;clinical&quot;</span>]],netDir,</span>
<span id="cb98-24"><a href="module-11-lab-2-pathway-level-features.html#cb98-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">simMetric=</span><span class="st">&quot;custom&quot;</span>,<span class="at">customFunc=</span>normDiff, <span class="do">### Notice simMetric &amp; customFunc</span></span>
<span id="cb98-25"><a href="module-11-lab-2-pathway-level-features.html#cb98-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">writeProfiles=</span><span class="cn">FALSE</span>,</span>
<span id="cb98-26"><a href="module-11-lab-2-pathway-level-features.html#cb98-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">sparsify=</span><span class="cn">TRUE</span>,</span>
<span id="cb98-27"><a href="module-11-lab-2-pathway-level-features.html#cb98-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">verbose=</span><span class="cn">FALSE</span>,</span>
<span id="cb98-28"><a href="module-11-lab-2-pathway-level-features.html#cb98-28" aria-hidden="true" tabindex="-1"></a>        ...)</span>
<span id="cb98-29"><a href="module-11-lab-2-pathway-level-features.html#cb98-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb98-30"><a href="module-11-lab-2-pathway-level-features.html#cb98-30" aria-hidden="true" tabindex="-1"></a>    netList <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">unlist</span>(netList),<span class="fu">unlist</span>(netList2))</span>
<span id="cb98-31"><a href="module-11-lab-2-pathway-level-features.html#cb98-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(netList)</span>
<span id="cb98-32"><a href="module-11-lab-2-pathway-level-features.html#cb98-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="build-predictor-1" class="section level2">
<h2>Build predictor</h2>
<p>Finally!
We have:</p>
<ul>
<li>prepared our data,</li>
<li>grouped RNA by pathways (<code>fetchPathwayDefinitions()</code>, <code>readPathways()</code>),</li>
<li>created two PSN using clinical variables (<code>groupList$clinical</code>), and</li>
<li>defined our similarity metrics (<code>makeNets()</code>).</li>
</ul>
<p>Now we build our predictors. For this tutorial, we use two train/test splits. For each split, we assign features a score between zero and two, and call features with score of 1+ “feature-selected”.</p>
<p><strong>Realistic parameters:</strong> When running this with your project, reasonable values are <code>numSplits=10L</code> (10 is a good start, just to see if you get signal, ~100 if firming up for publication), <code>featScoreMax=10L</code>, <code>featSelCutoff=9L</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb99-1"><a href="module-11-lab-2-pathway-level-features.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># make results reproducible</span></span>
<span id="cb99-2"><a href="module-11-lab-2-pathway-level-features.html#cb99-2" aria-hidden="true" tabindex="-1"></a>outDir <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s2&quot;</span>,<span class="fu">tempdir</span>()),<span class="st">&quot;pred_output&quot;</span>,<span class="at">sep=</span><span class="fu">getFileSep</span>()) <span class="co"># use absolute path</span></span>
<span id="cb99-3"><a href="module-11-lab-2-pathway-level-features.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(outDir)) <span class="fu">unlink</span>(outDir,<span class="at">recursive=</span><span class="cn">TRUE</span>)</span>
<span id="cb99-4"><a href="module-11-lab-2-pathway-level-features.html#cb99-4" aria-hidden="true" tabindex="-1"></a>numSplits <span class="ot">&lt;-</span> 10L</span>
<span id="cb99-5"><a href="module-11-lab-2-pathway-level-features.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="do">##model &lt;- suppressMessages(</span></span>
<span id="cb99-6"><a href="module-11-lab-2-pathway-level-features.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   buildPredictor(</span></span>
<span id="cb99-7"><a href="module-11-lab-2-pathway-level-features.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     dataList=brca,</span></span>
<span id="cb99-8"><a href="module-11-lab-2-pathway-level-features.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="do">##     groupList=groupList,</span></span>
<span id="cb99-9"><a href="module-11-lab-2-pathway-level-features.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     makeNetFunc=makeNets,</span></span>
<span id="cb99-10"><a href="module-11-lab-2-pathway-level-features.html#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     outDir=outDir, </span></span>
<span id="cb99-11"><a href="module-11-lab-2-pathway-level-features.html#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     numSplits=numSplits, </span></span>
<span id="cb99-12"><a href="module-11-lab-2-pathway-level-features.html#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     featScoreMax=2L, </span></span>
<span id="cb99-13"><a href="module-11-lab-2-pathway-level-features.html#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="do">##     featSelCutoff=1L,</span></span>
<span id="cb99-14"><a href="module-11-lab-2-pathway-level-features.html#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="do">##     numCores=8L</span></span>
<span id="cb99-15"><a href="module-11-lab-2-pathway-level-features.html#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     )</span></span>
<span id="cb99-16"><a href="module-11-lab-2-pathway-level-features.html#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="do">##)</span></span></code></pre></div>
<p>Let’s load the results:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb100-1"><a href="module-11-lab-2-pathway-level-features.html#cb100-1" aria-hidden="true" tabindex="-1"></a>outFile <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s2/CBW_Lab2_full.rda&quot;</span>,<span class="fu">tempdir</span>())</span>
<span id="cb100-2"><a href="module-11-lab-2-pathway-level-features.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://github.com/RealPaiLab/CBW_CAN_DataIntegration_2021/raw/master/supporting_files/Lab2_files/brca_binary_pathways.rda&quot;</span>,</span>
<span id="cb100-3"><a href="module-11-lab-2-pathway-level-features.html#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile=</span>outFile)</span>
<span id="cb100-4"><a href="module-11-lab-2-pathway-level-features.html#cb100-4" aria-hidden="true" tabindex="-1"></a>lnames <span class="ot">&lt;-</span> <span class="fu">load</span>(outFile)</span></code></pre></div>
<p>We can see the objects in the file using <code>lnames()</code>.</p>
</div>
<div id="examine-results-1" class="section level2">
<h2>Examine results</h2>
<p>As before, we get model results, using <code>getResults()</code> from our helper script, <code>helper.R</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb101-1"><a href="module-11-lab-2-pathway-level-features.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;helper.R&quot;</span>)</span>
<span id="cb101-2"><a href="module-11-lab-2-pathway-level-features.html#cb101-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">getResults</span>(brca,model_full,</span>
<span id="cb101-3"><a href="module-11-lab-2-pathway-level-features.html#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">featureSelCutoff=</span>9L,</span>
<span id="cb101-4"><a href="module-11-lab-2-pathway-level-features.html#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">featureSelPct=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## Detected 10 splits and 2 classes</code></pre>
<pre><code>## * Plotting performance</code></pre>
<pre><code>## * Compiling feature scores and calling selected features</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>As this is binary classification, we get ROC and precision-recall curves (bottom panel). The average AUROC and AUPR are shown in the top panel.
Let’s take a look at the average performance:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb105-1"><a href="module-11-lab-2-pathway-level-features.html#cb105-1" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> results<span class="sc">$</span>performance</span>
<span id="cb105-2"><a href="module-11-lab-2-pathway-level-features.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(perf<span class="sc">$</span>splitAUROC),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 99</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb107-1"><a href="module-11-lab-2-pathway-level-features.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(perf<span class="sc">$</span>splitAUPR),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 97</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb109-1"><a href="module-11-lab-2-pathway-level-features.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(perf<span class="sc">$</span>splitAccuracy),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 86</code></pre>
<p>Notice that although the AUROC is near perfect, the accuracy is lower, at around 86%. It is important to consider several measures of predictor performance to understand the behaviour of the predictor.</p>
<p>Let’s examine our confusion matrix:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb111-1"><a href="module-11-lab-2-pathway-level-features.html#cb111-1" aria-hidden="true" tabindex="-1"></a>confMat <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(model_full)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p><em>Note: Rows of this matrix don’t add up to 100% because the matrix is an average of the confusion matrices from all of the train/test splits.</em></p>
<p>We see that the predictor performs perfectly at classifying Luminal A tumours but does worse at classifying the residual, mainly because it often classifies other tumours as Luminal A!</p>
<div class="rmd-note">
<p>
Particularly when there is class imbalance, i.e. one class has several-fold the number of samples than the other, predictors can achieve a baseline high accuracy by “cheating” and simply predicting all samples as being of the dominating label. e.g. if you have 99:1 class imbalance of two classes A and B, the predictor can achieve 99% accuracy simply by calling all samples of type “A”!
</p>
<p>
In practice, class imbalance should be handled using suitable performance evaluation metrics and sampling proportionally for training/test sets.
</p>
</div>
<p>We indeed have a class imbalance in this dataset:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb112-1"><a href="module-11-lab-2-pathway-level-features.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">colData</span>(brca)<span class="sc">$</span>STATUS,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Luminal.A     other      &lt;NA&gt; 
##       230        94         0</code></pre>
<p>This function returns the confusion matrix for each split, as well as the average shown in the image above:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb114-1"><a href="module-11-lab-2-pathway-level-features.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(confMat)</span></code></pre></div>
<pre><code>##                     Length Class  Mode   
## splitWiseConfMatrix 10     -none- list   
## average              4     table  numeric</code></pre>
</div>
<div id="visualize-top-pathways-in-cytoscape" class="section level2">
<h2>Visualize top pathways in Cytoscape</h2>
<p>We will now visualize top-scoring pathways using the Cytoscape visualization EnrichmentMap. Recall from Module 8 that an EnrichmentMap is a network visualization of related gene-sets, where each node is a pathway and edges connect similar pathways.</p>
<p>Let us say we only want to see pathways that scored in some target range for “most” of the trials; i.e. consistently high-scoring pathways.
We quantify this by asking only for features that score [<code>EMapMinScore</code>,<code>EMapMaxScore</code>] for <code>EMapPctPass</code> fraction of trials.</p>
<p>Here we ask for features scoring 7+ out of 10 for at least 70% of the train/test splits.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="module-11-lab-2-pathway-level-features.html#cb116-1" aria-hidden="true" tabindex="-1"></a>emap <span class="ot">&lt;-</span> <span class="fu">makeInputForEnrichmentMap</span> (</span>
<span id="cb116-2"><a href="module-11-lab-2-pathway-level-features.html#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">model=</span>model_full,</span>
<span id="cb116-3"><a href="module-11-lab-2-pathway-level-features.html#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">results=</span>results,</span>
<span id="cb116-4"><a href="module-11-lab-2-pathway-level-features.html#cb116-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pathwayList=</span>pathList,</span>
<span id="cb116-5"><a href="module-11-lab-2-pathway-level-features.html#cb116-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMapMinScore=</span>7L, </span>
<span id="cb116-6"><a href="module-11-lab-2-pathway-level-features.html#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMapMaxSore=</span>10L,</span>
<span id="cb116-7"><a href="module-11-lab-2-pathway-level-features.html#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMapPctPass=</span><span class="fl">0.7</span>,</span>
<span id="cb116-8"><a href="module-11-lab-2-pathway-level-features.html#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">outDir=</span><span class="fu">tempdir</span>() </span>
<span id="cb116-9"><a href="module-11-lab-2-pathway-level-features.html#cb116-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## * Creating input files for EnrichmentMap</code></pre>
<pre><code>## * Writing files for network visualization</code></pre>
<p>This call will return paths to the output files, which you need to now download from AWS to your personal computer:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb119-1"><a href="module-11-lab-2-pathway-level-features.html#cb119-1" aria-hidden="true" tabindex="-1"></a>emap</span></code></pre></div>
<pre><code>## $GMTfiles
## $GMTfiles$Luminal.A
## [1] &quot;/tmp/RtmppmEQJv/Luminal.A.gmt&quot;
## 
## $GMTfiles$other
## [1] &quot;/tmp/RtmppmEQJv/other.gmt&quot;
## 
## 
## $NodeStyles
## $NodeStyles$Luminal.A
## [1] &quot;/tmp/RtmppmEQJv/Luminal.A_nodeAttrs.txt&quot;
## 
## $NodeStyles$other
## [1] &quot;/tmp/RtmppmEQJv/other_nodeAttrs.txt&quot;</code></pre>
<p>netDx can directly generate EnrichmentMaps on a locally-installed version of Cytosape using <a href="https://bioconductor.org/packages/release/bioc/html/RCy3.html">RCy3</a><span class="citation"><sup><a href="#ref-Gustavsen2019-ec" role="doc-biblioref">7</a></sup></span>. RCy3 allows programmatic control of Cytoscape from within R, so that visualizations such as EnrichmentMap can be programmatically created. This step needs a local copy of Cytoscape installed, so it won’t work on the lab AWS instance. Try it on your laptop after the lab.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb121-1"><a href="module-11-lab-2-pathway-level-features.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">###plotEmap(gmtFiles[[1]],nodeAttrFiles[[1]],</span></span>
<span id="cb121-2"><a href="module-11-lab-2-pathway-level-features.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="do">###         groupClusters=TRUE, hideNodeLabels=TRUE)</span></span></code></pre></div>
<p>If you wanted to look at an EnrichmentMap anyway, you can download the input files shown in the output of the <code>emap</code> object above by opening your web browser to: <code>http://your-student-instance</code> and downloading the files from there. Then build an Enrichment map using Cytoscape on your laptop as discussed earlier in the Cancer Analysis workshop.</p>
<p>When you’re done, the Enrichment Map for top pathways predictive of Luminal A status would look like this (below). The speech bubbles show pathway names within a couple top clusters.</p>
<div class="figure"><span id="fig:unnamed-chunk-60"></span>
<img src="images/Lab2_EMap.jpg" alt="Lab 2: EnrichmentMap for top-scoring pathways predictive of Luminal A status. Nodes show pathways scoring 7+ out of 10 in over 70% of train/test splits. Edges connect pathways with shared genes. Yellow bubbles show pathway clusters, labelled by AutoAnnotate [@Kucera2016-yj]. Node fills indicate top score in 70%+ of the splits. Speech bubbles show pathways in example clusters." width="140%" />
<p class="caption">
Figure 5: Lab 2: EnrichmentMap for top-scoring pathways predictive of Luminal A status. Nodes show pathways scoring 7+ out of 10 in over 70% of train/test splits. Edges connect pathways with shared genes. Yellow bubbles show pathway clusters, labelled by AutoAnnotate.<span class="citation"><sup><a href="#ref-Kucera2016-yj" role="doc-biblioref">8</a></sup></span> Node fills indicate top score in 70%+ of the splits. Speech bubbles show pathways in example clusters.
</p>
</div>
<p><strong>Optional:</strong> You can also <a href="https://github.com/RealPaiLab/CBW_CAN_DataIntegration_2021/raw/master/supporting_files/Lab2_files/LuminalA.cys">download the Cytoscape session file here</a> to see the finished result.</p>
<div class="rmd-note">
<p>
In practice, it can take a good portion of an hour to adjust the layout of the EnrichmentMap, and often longer to explore the contents. The automatically-generated pathway theme labels are often a reasonable first guess, but you’ll find you’ll often revise them upon closer inspection of the pathways within.
</p>
</div>
<p>We notice that the Enrichment Map identifies several pathways known to be dysregulated in Luminal A breast tumours, including estrogen receptor-mediating signaling (PLASMA_MEMBRANE_ESTROGEN_RESPONSE_SIGNALING), p38 signaling, pathways related to genomic stability and DNA damage response (ATM), cell profileration-related signaling (ErbB signaling).</p>
</div>
<div id="outlook" class="section level2">
<h2>Outlook</h2>
<div class="rmd-outlook">
<p>
Where do you go from here? That depends on your study goals and prior knowledge. Here are some possibilities:
</p>
<ul>
<li>
You may choose to focus on particular pathways for which you have targeting tools, for follow-up <em>in vitro</em> or <em>in vivo</em> experiments.
</li>
<li>
You may want to improve performance, in which case consider changing predictor design, including features, predictor settings, or pathway set choices. <em>Note: This is usually a good idea.</em>
</li>
<li>
Once you’re satisfied with predictor design, you may want to <a href="http://bioconductor.org/packages/release/bioc/vignettes/netDx/inst/doc/ValidateNew.html">validate on an independent dataset</a>. This is something we haven’t covered in this lab.
</li>
</ul>
<p>
Machine learning is very much trial-and-error, and you have to be prepared to try a variety of designs to see what works.
</p>
<p>
Future versions of netDx will include tools to help with some of this automation &amp; also digging deeper into predictive features such as pathways, to understand what components contribute to predictive power.
</p>
</div>
<p>That’s it! This completes our lab exercises for Module 11.</p>
</div>
<div id="sessioninfo-1" class="section level2">
<h2>sessionInfo</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode r codeblock"><code class="sourceCode r"><span id="cb122-1"><a href="module-11-lab-2-pathway-level-features.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.0.5 (2021-03-31)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=C                 LC_NUMERIC=C               LC_TIME=C                  LC_COLLATE=C              
##  [5] LC_MONETARY=C              LC_MESSAGES=C              LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] plotrix_3.8-1               ggplot2_3.3.3               Rtsne_0.15                  netDx_1.2.3                
##  [5] bigmemory_4.5.36            rhdf5_2.34.0                curatedTCGAData_1.12.1      MultiAssayExperiment_1.16.0
##  [9] SummarizedExperiment_1.20.0 Biobase_2.50.0              GenomicRanges_1.42.0        GenomeInfoDb_1.26.7        
## [13] IRanges_2.24.1              S4Vectors_0.28.1            BiocGenerics_0.36.1         MatrixGenerics_1.2.1       
## [17] matrixStats_0.58.0         
## 
## loaded via a namespace (and not attached):
##   [1] utf8_1.2.1                    R.utils_2.10.1                tidyselect_1.1.1              RSQLite_2.2.7                
##   [5] AnnotationDbi_1.52.0          grid_4.0.5                    combinat_0.0-8                BiocParallel_1.24.1          
##   [9] RNeXML_2.4.5                  munsell_0.5.0                 codetools_0.2-18              withr_2.4.2                  
##  [13] colorspace_2.0-1              highr_0.9                     knitr_1.33                    uuid_0.1-4                   
##  [17] zinbwave_1.12.0               rstudioapi_0.13               SingleCellExperiment_1.12.0   ROCR_1.0-11                  
##  [21] NMF_0.23.0                    labeling_0.4.2                GenomeInfoDbData_1.2.4        farver_2.1.0                 
##  [25] bit64_4.0.5                   vctrs_0.3.8                   generics_0.1.0                xfun_0.23                    
##  [29] BiocFileCache_1.14.0          R6_2.5.0                      doParallel_1.0.16             ggbeeswarm_0.6.0             
##  [33] netSmooth_1.10.0              rsvd_1.0.5                    RJSONIO_1.3-1.4               locfit_1.5-9.4               
##  [37] bitops_1.0-7                  rhdf5filters_1.2.1            cachem_1.0.5                  DelayedArray_0.16.3          
##  [41] assertthat_0.2.1              promises_1.2.0.1              scales_1.1.1                  beeswarm_0.3.1               
##  [45] gtable_0.3.0                  phylobase_0.8.10              beachmat_2.6.4                rlang_0.4.11                 
##  [49] genefilter_1.72.1             splines_4.0.5                 lazyeval_0.2.2                BiocManager_1.30.15          
##  [53] yaml_2.2.1                    reshape2_1.4.4                httpuv_1.6.1                  tools_4.0.5                  
##  [57] bookdown_0.22                 gridBase_0.4-7                ellipsis_0.3.2                jquerylib_0.1.4              
##  [61] RColorBrewer_1.1-2            Rcpp_1.0.6                    plyr_1.8.6                    sparseMatrixStats_1.2.1      
##  [65] progress_1.2.2                zlibbioc_1.36.0               purrr_0.3.4                   RCurl_1.98-1.3               
##  [69] prettyunits_1.1.1             viridis_0.6.1                 cluster_2.1.1                 tinytex_0.31                 
##  [73] magrittr_2.0.1                data.table_1.14.0             RSpectra_0.16-0               hms_1.1.0                    
##  [77] mime_0.10                     evaluate_0.14                 xtable_1.8-4                  XML_3.99-0.6                 
##  [81] jpeg_0.1-8.1                  gridExtra_2.3                 shape_1.4.6                   compiler_4.0.5               
##  [85] scater_1.18.6                 tibble_3.1.2                  RCy3_2.10.2                   crayon_1.4.1                 
##  [89] R.oo_1.24.0                   htmltools_0.5.1.1             entropy_1.3.0                 later_1.2.0                  
##  [93] tidyr_1.1.3                   howmany_0.3-1                 DBI_1.1.1                     ExperimentHub_1.16.1         
##  [97] dbplyr_2.1.1                  MASS_7.3-53.1                 rappdirs_0.3.3                Matrix_1.3-2                 
## [101] ade4_1.7-16                   R.methodsS3_1.8.1             igraph_1.2.6                  pkgconfig_2.0.3              
## [105] bigmemory.sri_0.1.3           rncl_0.8.4                    registry_0.5-1                locfdr_1.1-8                 
## [109] scuttle_1.0.4                 xml2_1.3.2                    foreach_1.5.1                 annotate_1.68.0              
## [113] vipor_0.4.5                   bslib_0.2.5.1                 rngtools_1.5                  pkgmaker_0.32.2              
## [117] XVector_0.30.0                stringr_1.4.0                 digest_0.6.27                 pracma_2.3.3                 
## [121] graph_1.68.0                  softImpute_1.4-1              rmarkdown_2.8                 edgeR_3.32.1                 
## [125] DelayedMatrixStats_1.12.3     curl_4.3.1                    kernlab_0.9-29                shiny_1.6.0                  
## [129] lifecycle_1.0.0               nlme_3.1-152                  jsonlite_1.7.2                clusterExperiment_2.10.1     
## [133] Rhdf5lib_1.12.1               BiocNeighbors_1.8.2           viridisLite_0.4.0             limma_3.46.0                 
## [137] fansi_0.4.2                   pillar_1.6.1                  lattice_0.20-41               fastmap_1.1.0                
## [141] httr_1.4.2                    survival_3.2-10               interactiveDisplayBase_1.28.0 glue_1.4.2                   
## [145] png_0.1-7                     iterators_1.0.13              BiocVersion_3.12.0            glmnet_4.1-1                 
## [149] bit_4.0.4                     stringi_1.6.2                 sass_0.4.0                    HDF5Array_1.18.1             
## [153] blob_1.2.1                    BiocSingular_1.6.0            AnnotationHub_2.22.1          memoise_2.0.0                
## [157] dplyr_1.0.6                   irlba_2.3.3                   ape_5.5</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-Merico2010-nc" class="csl-entry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Merico, D., Isserlin, R., Stueker, O., Emili, A. &amp; Bader, G. D. Enrichment map: A network-based method for gene-set enrichment visualization and interpretation. <em>PLoS One</em> <strong>5,</strong> e13984 (2010).</div>
</div>
<div id="ref-Subramanian2005-am" class="csl-entry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Subramanian, A. <em>et al.</em> Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles. <em>Proc. Natl. Acad. Sci. U. S. A.</em> <strong>102,</strong> 15545–15550 (2005).</div>
</div>
<div id="ref-Gustavsen2019-ec" class="csl-entry">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Gustavsen, J. A., Pai, S., Isserlin, R., Demchak, B. &amp; Pico, A. R. <span>RCy3</span>: Network biology using cytoscape from within <span>R</span>. <em>F1000Res.</em> <strong>8,</strong> 1774 (2019).</div>
</div>
<div id="ref-Kucera2016-yj" class="csl-entry">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Kucera, M., Isserlin, R., Arkhangorodsky, A. &amp; Bader, G. D. <span>AutoAnnotate</span>: A cytoscape app for summarizing networks with semantic annotations. <em>F1000Res.</em> <strong>5,</strong> 1717 (2016).</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="module-11-lab-1-three-way-classifier-from-four-genomic-layers.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-PathwayFeatures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
